<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script type="text/javascript" src="./comlib.js"></script>
</head>

<body>    
    <script type="text/javascript">
        var name = "鄭惠文";
        var seat = rand(1,30);
        var age = rand(1,50); 
        var tall = 157.5;
        var student = false;
        var interset = null; //興趣
        var want;  //希望在js課得到什麼
        var interset1 = "看電影、聽音樂、看書"; //興趣
        var want1 = "熟悉程式語言的特色,並且希望能應用自如。";  //希望在js課得到什麼
        var score = [rand(1,100),rand(1,100),rand(1,100)]; //國0、英1、數2成績
        var mobile = {  //所攜帶的手機規格
            tel: "09123415678",
            os: "android",
            brand: "SONY",
            size: "6.5inch"
        }; 
        score.splice(1,0,rand(1,100)); //國0,自1,英2,數3成績
        console.log(score);
        score.splice(3,0,rand(1,100)); //國0,自1,英2,社3,數4成績
        console.log(score);
        var sum=0;
        for(i=0;i<=4;i++){
            sum=sum+score[i];
        }
        average=sum/5; //計算平均成績
        score.push(average); //將成績放在陣列的最後端
        //score.splice(5,0,(score[0]+score[1]+score[2]+score[3]+score[4])/5)
        //計算27個月的年齡與月份
        function countAge(age,nowMonths,cmonths){
            let newYear=Math.floor((nowMonths+cmonths)/12);
            let newMonth=(nowMonths+cmonths)%12;
            return age+newYear+"歲,又"+newMonth+"個月";
        }; 
        //1. 處理表格成績60分以下,成績前標示*,且設為紅字
        //2. 90分以上含90,設為綠色背景,白色的字
        function scoreNg(scoreck){
            if (scoreck<60){
                    return ("<span style='color:red;'>*"+scoreck+"</span>");
            }else if(scoreck>=90){
                   return ("<span style='background:green; color:white'>"+scoreck+"</span>");
            }else{            
                   return (scoreck);
            }
        };        
        //依座號排位子函數
        function setSeat(number,limit=8){ //只帶入一個變數時,系統自動帶入第二個變數,且值為8
            if (number==17){
                number=32;
            }
            //計算出實際哪一排
            newRow=Math.ceil(number/limit); //ceil無條件進位            
            if ((number%limit)==0){
                newCol=limit;
            }else{
                newCol=(number%limit);
            }
            return ("教室位子為第"+newRow+"排,第"+newCol+"位");
        };     
    </script>
    <table border="1">
        <tr>
            <td>姓名</td>
            <td>
                <script>document.write(name);</script>
            </td>
            <td>
                <script>document.write(typeof (name));</script>
            </td>
        </tr>
        <tr>
            <td>座號</td>
            <td>
                <script>document.write(seat);</script>
            </td>
            <td>
                <script>document.write(typeof (seat));</script>
            </td>
        </tr>       
        <tr>
            <td>學生座號
                <script>document.write(seat);</script>
            </td>
            <td>
                <script>
                   document.write(setSeat(seat));
                </script>
            </td>
            <td>
                --
            </td>
        </tr>       
        <tr>
            <td>年齡</td>
            <td>
                <script>document.write(age);</script>
            </td>
            <td>
                <script>document.write(typeof (age));</script>
            </td>
        </tr>
        <tr>
            <td>
                <script>                    
                    document.write("目前年齡"+age+"歲,又6個月,計27個月之後為");
                </script>
            </td>
            <td>
                <script>                    
                    document.write(countAge(age,6,27));
                </script>
            </td>
            <td>
                --
            </td>
        </tr>
        <tr>
            <td>身高</td>
            <td>
                <script>document.write(tall);</script>
            </td>
            <td>
                <script>document.write(typeof (tall));</script>
            </td>
        </tr>
        <tr>
            <td>是否在學</td>
            <td>
                <script>document.write(student);</script>
            </td>
            <td>
                <script>document.write(typeof (student));</script>
            </td>
        </tr>
        <tr>
            <td>興趣(null空值,歸物件)</td>
            <td>
                <script>document.write(interset);</script>
            </td>
            <td>
                <script>document.write(typeof (interset));</script>
            </td>
        </tr>
        <tr bgcolor="yellow">
            <td>興趣(內容更新)</td>
            <td>
                <script>document.write(interset1);</script>
            </td>
            <td>
                <script>document.write(typeof (interset1));</script>
            </td>
        </tr>
        <tr>
            <td>希望在js課得到什麼(未設定,即未定義)</td>
            <td>
                <script>document.write(want);</script>
            </td>
            <td>
                <script>document.write(typeof (want));</script>
            </td>
        </tr>
        <tr bgcolor="yellow">
            <td>希望在js課得到什麼(內容更新)</td>
            <td>
                <script>document.write(want1);</script>
            </td>
            <td>
                <script>document.write(typeof (want1));</script>
            </td>
        </tr>
        <tr>
            <td>成績(陣列歸物件)</td>
            <td>
                <table border="1" bordercolor="green">
                    <tr>
                        <td>國文</td>
                        <td>自然</td>
                        <td>英文</td>
                        <td>社會</td>
                        <td>數學</td>
                        <td>平均成績</td>
                    </tr>
                    <tr>
                        <td>
                            <script>document.write(scoreNg(score[0]));</script>
                        </td>
                        <td>
                            <script>document.write(scoreNg(score[1]));</script>
                        </td>
                        <td>
                            <script>document.write(scoreNg(score[2]));</script>
                        </td>
                        <td>
                            <script>document.write(scoreNg(score[3]));</script>
                        </td>
                        <td>
                            <script>document.write(scoreNg(score[4]));</script>
                        </td>
                        <td>
                            <script>document.write(scoreNg(score[5]));</script>
                        </td>
                    </tr>
                </table>
            </td>
            <td>
                <script>document.write(typeof (score));</script>
            </td>
        </tr>
        <tr>
            <td>使用手機規格(object即物件)</td>
            <td>
                <table border="1" bordercolor="blue">
                    <tr>
                        <td>電話</td>
                        <td>系統</td>
                        <td>品牌</td>
                        <td>大小</td>
                    </tr>
                    <tr>
                        <td>
                            <script>document.write(mobile.tel);</script>
                        </td>
                        <td>
                            <script>document.write(mobile.os);</script>
                        </td>
                        <td>
                            <script>document.write(mobile.brand);</script>
                        </td>
                        <td>
                            <script>document.write(mobile.size);</script>
                        </td>
                    </tr>
                </table>
            </td>
            <td>
                <script>document.write(typeof (mobile));</script>
            </td>
        </tr>
    </table>
</body>

</html>